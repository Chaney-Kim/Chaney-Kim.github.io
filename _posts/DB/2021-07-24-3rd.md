---
layout: single
title: "DB) 21.07.24"
categories: DB
---
## Web Server Setting
- - - - 
## PK, Constraint 설정

지난 시간에 이어 테이블에서의 PK와 각종 제약조건들을 설정하고 실행해보자.

우선 **DESC article;**로 현재 article 테이블의 상태를 확인하자.

![image](https://user-images.githubusercontent.com/52832956/126859490-22ebd85a-1030-480f-af42-f025c3ba48c4.png)

현재 상태에서 테이블의 데이터를 유일하게 식별할 수 있도록 하는 기본키를 추가해보자.

id 칼럼을 추가하여 기본키로 지정하자.

기본키는 모든 튜플들을 유일하게 식별해야하므로 NULL 값을 가질 수 없고, 항상 유효한 값을 가져야 한다.

```
ALTER TABLE article ADD COLUMN id INT UNIQUE;
```
> 우선 id 컬럼을 추가하고 unique로 중복 불가 제약투터 걸어준다.

![image](https://user-images.githubusercontent.com/52832956/126859856-f7853321-2ba7-4117-9540-fbe49cdefdeb.png)

> KEY에 UNI라고 적힌 것을 볼 수 있다.

```
ALTER TABLE article DROP COLUMN id;
ALTER TABLE article ADD COLUMN id INT UNIQUE NOT NULL;
```
> 칼럼을 삭제한 뒤, not null 속성도 추가해서 다시 만들어 준다.

![image](https://user-images.githubusercontent.com/52832956/126859907-88d46b97-2cde-4807-b1aa-8bcd7bc732cd.png)

> KEY가 PRI이라고 바뀐 것을 볼 수 있다.

```
INSERT INTO article
SET title = '제목1',
`body` = '내용1';
```
![image](https://user-images.githubusercontent.com/52832956/126860034-4b5d9f84-c71e-418c-bee1-56bd23694933.png)

> 이제 기본키 없이 데이터를 추가하면 기본키에러가 난다!


이 기본키는 데이터가 추가될 때 중복없이 부여되게끔 해야하므로 내가 일일히 수동으로 값이 중복되지 않게 부여하는 것 보다 자동으로 값이 증가되게 하면 더 좋을 것이다.

이때, 사용하는 명령어가 AUTO_INCREMENT인데 주의할 점은 이미 존재하는 컬럼에 제약조건을 추가하는 것이므로 add가 아닌 modify를 사용하도록 한다.

```
ALTER TABLE article MODIFY COLUMN id INT NOT NULL AUTO_INCREMENT;

INSERT INTO article
SET title = '제목1',
`body` = '내용1';

INSERT INTO article
SET title = '제목2',
`body` = '내용2';

INSERT INTO article
SET title = '제목3',
`body` = '내용3';
```
![image](https://user-images.githubusercontent.com/52832956/126860100-7e59f3eb-3ee7-45fd-9e9e-ba556dc63f86.png)

> 따로 id에 대한 입력이 없어도 알아서 값이 잘 증가한다.

최종 테이블 상태
![image](https://user-images.githubusercontent.com/52832956/126860118-245d5eb8-e39c-4407-8ded-cff96a5c2715.png)
